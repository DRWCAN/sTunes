<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="sTunes_orginal.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3862"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="vw_invoices" custom_title="0" dock_id="1" table="4,11:mainvw_invoices"/><dock_state state="000000ff00000000fd0000000100000002000005bb0000038efc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000005bb0000016200ffffff000005bb0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Sample View 1" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="62"/><column index="2" value="75"/><column index="3" value="159"/><column index="4" value="300"/><column index="5" value="159"/><column index="6" value="72"/><column index="7" value="119"/><column index="8" value="104"/><column index="9" value="47"/><column index="10" value="85"/><column index="11" value="79"/><column index="12" value="103"/><column index="13" value="300"/><column index="14" value="300"/><column index="15" value="159"/><column index="16" value="55"/><column index="17" value="119"/><column index="18" value="87"/><column index="19" value="159"/><column index="20" value="151"/><column index="21" value="239"/><column index="22" value="87"/><column index="23" value="75"/><column index="24" value="74"/><column index="25" value="75"/><column index="26" value="159"/><column index="27" value="67"/><column index="28" value="159"/><column index="29" value="159"/><column index="30" value="135"/><column index="31" value="63"/><column index="32" value="49"/><column index="33" value="63"/><column index="34" value="81"/><column index="35" value="143"/><column index="36" value="143"/><column index="37" value="199"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="albums" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="56"/><column index="2" value="300"/><column index="3" value="54"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="artists" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="52"/><column index="2" value="300"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customers" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="2" mode="1"/></sort><column_widths><column index="1" value="75"/><column index="2" value="79"/><column index="3" value="103"/><column index="4" value="300"/><column index="5" value="300"/><column index="6" value="159"/><column index="7" value="55"/><column index="8" value="119"/><column index="9" value="87"/><column index="10" value="159"/><column index="11" value="151"/><column index="12" value="239"/><column index="13" value="89"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="employees" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="75"/><column index="2" value="71"/><column index="3" value="71"/><column index="4" value="159"/><column index="5" value="67"/><column index="6" value="159"/><column index="7" value="159"/><column index="8" value="223"/><column index="9" value="87"/><column index="10" value="39"/><column index="11" value="55"/><column index="12" value="71"/><column index="13" value="143"/><column index="14" value="143"/><column index="15" value="199"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="genres" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="54"/><column index="2" value="151"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="invoice_items" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="85"/><column index="2" value="64"/><column index="3" value="54"/><column index="4" value="59"/><column index="5" value="57"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="invoices" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="8" mode="1"/></sort><column_widths><column index="1" value="62"/><column index="2" value="77"/><column index="3" value="159"/><column index="4" value="300"/><column index="5" value="159"/><column index="6" value="72"/><column index="7" value="119"/><column index="8" value="104"/><column index="9" value="47"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="media_types" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="82"/><column index="2" value="223"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="playlist_track" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="63"/><column index="2" value="54"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="playlists" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="61"/><column index="2" value="215"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sqlite_sequence" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="111"/><column index="2" value="39"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sqlite_stat1" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="119"/><column index="2" value="271"/><column index="3" value="87"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="tracks" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="0" mode="0"/></sort><column_widths><column index="1" value="52"/><column index="2" value="300"/><column index="3" value="58"/><column index="4" value="84"/><column index="5" value="56"/><column index="6" value="300"/><column index="7" value="76"/><column index="8" value="71"/><column index="9" value="59"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="vw_invoices" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="75"/><column index="2" value="64"/><column index="3" value="71"/><column index="4" value="75"/><column index="5" value="39"/><column index="6" value="119"/><column index="7" value="87"/><column index="8" value="62"/><column index="9" value="85"/><column index="10" value="159"/><column index="11" value="72"/><column index="12" value="119"/><column index="13" value="47"/><column index="14" value="72"/><column index="15" value="52"/><column index="16" value="59"/><column index="17" value="62"/><column index="18" value="54"/><column index="19" value="69"/><column index="20" value="64"/><column index="21" value="151"/><column index="22" value="159"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">/*
CREATED ON: 2024-11-08
CREATED BY: DARREN WIEBE
DESCRIPTION: Illustrate total and average invoice sales for the USA grouped by year.
FORMULAE USED:
	STRFTIME
	SUM
	ROUND
	AVG
	NON AGGREGATE FILTER WHERE
	GROUP BY
	ORDER BY
	ALIAS
*/

SELECT
	strftime('%Y',InvoiceDate) AS [Year],
	sum(total) AS [Total USA Sales],
	round(avg(total),2) AS [Average USA Sales]
FROM
	invoices
WHERE
	BillingCountry = 'USA'
GROUP BY
	Year
ORDER BY
	Year DESC;</sql><sql name="SQL 2">/*
CREATED ON: 2024-11-08
CREATED BY: DARREN WIEBE
DESCRIPTION: Illustrate total and average USA invoice sales per state.
FORMULAE USED:
	STRFTIME
	SUM
	ROUND
	AVG
	NON AGGREGATE FILTER WHERE
	GROUP BY
	ORDER BY
	ALIAS
*/

SELECT
	strftime('%Y',InvoiceDate) AS [Year],
	BillingState AS [State],
	sum(total) AS [Total USA Sales per State],
	round(avg(total),2) AS [Average USA Sales per State]
FROM
	invoices
WHERE
	BillingCountry = 'USA'
GROUP BY
	State,
	Year
ORDER BY
	Year DESC;</sql><sql name="SQL 3">/*
CREATED ON: 2024-12-09
CREATED BY: DARREN WIEBE
DESCRIPTION: Provide a breakdown of invoice 397 by genre, genre price and track count.
FORMULAE USED:
	tablename.FieldName CONVENTION
	ROUND
	SUM
	INNER JOIN
	NON AGGREGRATE FILTER WHERE
	GROUP BY
	ALIAS
*/

SELECT
	g.name AS [Genre],
	round(sum(ii.UnitPrice),2) AS [Genre Price],
	count(t.TrackId) AS [Number of Tracks],
	i.total AS [Invoice 397 Total]
FROM
	genres g
INNER JOIN
	tracks t
ON
	t.GenreId = g.GenreId
INNER JOIN
	invoice_items ii
ON
	ii.TrackId = t.TrackId
INNER JOIN
	invoices i
ON	
	ii.InvoiceId = i.InvoiceId
WHERE
	ii.InvoiceId = 397
GROUP BY
	Genre;</sql><sql name="SQL 4">/*
CREATED ON: 2024-12-09
CREATED BY: DARREN WIEBE
DESCRIPTION: Provide a breakdown of invoices by genre, genre unit price, invoice id, state and year.
FORMULAE USED:
	tablename.FieldName CONVENTION
	STRFTIME
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	ORDER BY
	ALIAS
*/

SELECT
	g.name AS [Genre],
	ii.UnitPrice AS [Genre Unit Price],
	ii.InvoiceId,
	i.BillingState AS [State],
	strftime('%Y',InvoiceDate) AS [Year]
FROM
	genres g
INNER JOIN
	tracks t
ON
	t.GenreId = g.GenreId
INNER JOIN
	invoice_items ii
ON
	ii.TrackId = t.TrackId
INNER JOIN
	invoices i
ON
	ii.InvoiceId = i.InvoiceId
WHERE
	i.BillingCountry = 'USA'
ORDER BY
	Year DESC;
	
	</sql><sql name="SQL 5">/*
CREATED ON: 2024-11-09
CREATED BY: DARREN WIEBE
DESCRIPTION: Illustrate total USA sales per year per state by genre.
FORMULAE USED:
	tablename.FieldName convention
	COUNT
	SUM
	STRFTIME
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	GROUP BY
	ORDER BY
	ALIAS
*/

SELECT	
	g.name AS [Genre],
	sum(t.UnitPrice) AS [Genre Total],
	count(t.TrackId) AS [Number of Tracks],
	i.BillingState AS [State],
	strftime('%Y',InvoiceDate) AS [Year]
FROM
	invoices i
INNER JOIN
	invoice_items ii
ON
	i.InvoiceId = ii.InvoiceId
INNER JOIN
	tracks t
ON
	ii.TrackId = t.TrackId
INNER JOIN
	genres g
ON
	t.GenreId = g.GenreId
WHERE
	i.BillingCountry = 'USA'
GROUP BY
	State,
	Year,
	Genre
ORDER BY
	State,
	Year DESC
	
</sql><sql name="SQL 6*">/*
CREATED ON: 2024-11-11
CREATED BY: DARREN WIEBE
DESCRIPTION: What were the top ten invoices globally in 2013? What was the average invoice total in 2013 for comparison purposes?
FORMULAE USED:
	tablename.FieldName convention
	CONCATENATION
	SELECT SUB QUERY
	ROUND
	AVG
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	ORDER BY
	LIMIT
	ALIAS
*/

SELECT
	c.FirstName||' '||c.LastName AS [Full Name],
	i.CustomerId AS [Customer ID],
	c.Country AS [Country],
	i.total AS [2013 Invoice Amount],
(SELECT
	round(avg(i.total),2) 
FROM
	invoices i) AS [2013 Average Invoice Amount]
FROM
	invoices i
INNER JOIN
	customers c
ON
	i.CustomerId = c.CustomerId
WHERE
	i.InvoiceDate &gt;= '2013-01-01' AND i.InvoiceDate &lt;= '2013-12-31'
ORDER BY
	[2013 Invoice Amount] DESC
LIMIT 10;
</sql><sql name="SQL 7*">/*
CREATED ON: 2024-11-11
CREATED BY: DARREN WIEBE
DESCRIPTION: Who were the top ten global customers in 2013? One customer can be associated with more than one invoice.
-- This query takes SQL 6 a bit further. 
FORMULAE USED:
	tablename.FieldName convention
	UPPER
	CONCATENATION
	SUM
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	GROUP BY
	ORDER BY
	LIMIT
	ALIAS
*/

SELECT
	upper(c.FirstName||' '||c.LastName) AS [Full Name],
	i.CustomerId AS [Customer ID],
	c.Country AS [Country],
	sum(i.total) AS [2013 Invoice Total]
FROM
	invoices i
INNER JOIN
	customers c
ON
	i.CustomerId = c.CustomerId
WHERE
	i.InvoiceDate &gt;= '2013-01-01' AND i.InvoiceDate &lt;= '2013-12-31'
GROUP BY
	[Customer ID]
ORDER BY
	[2013 Invoice Total] DESC
LIMIT 10;
	
	</sql><sql name="SQL 8">/*
CREATED ON: 2024-11-20
CREATED BY: DARREN WIEBE
DESCRIPTION: What were the top 5 genres in sales in 2013 for the state of California?
*/

SELECT
	strftime('%Y',i.InvoiceDate) AS [Year],
	i.BillingState AS [State],
	g.name AS [Genre],
	sum(t.UnitPrice) AS [Total Sales]
FROM
	invoices i
INNER JOIN
	invoice_items ii
ON
	ii.InvoiceId = i.InvoiceId
INNER JOIN
	tracks t
ON
	ii.TrackId = t.TrackId
INNER JOIN
	genres g
ON
	t.GenreId = g.GenreId
WHERE
	i.BillingState = 'CA' AND (i.InvoiceDate &gt;= '2013-01-01' AND i.InvoiceDate &lt;= '2013-12-31')
GROUP BY
	Genre
ORDER BY
	[Total Sales] DESC
LIMIT 5;
	
</sql><sql name="SQL 9">/*
CREATED ON: 2024-11-12
CREATED BY: DARREN WIEBE
DESCRIPTION: List the track name and the album title for the band Metallica.
FORMULAE USED:
	tablename.FieldName convention
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	ALIAS
*/

SELECT
	t.name AS [Track Name],
	a.Title AS [Album Title]
FROM
	tracks t
INNER JOIN
	albums a
ON
	t.AlbumId = a.AlbumId
WHERE
	t.Composer = 'Metallica';</sql><sql name="SQL 10">/*
CREATED ON: 2024-11-12
CREATED BY: DARREN WIEBE
DESCRIPTION: List the tracks for the album 'Appetite for Destruction'.
FORMULAE USED:
	tablename.FieldName convention
	INNER JOIN
	NON AGGREGATE FILTER WHERE
	ALIAS
*/

SELECT
	t.name AS [Track Name for Album Appetite for Destruction]
FROM
	tracks t
INNER JOIN
	albums a
ON
	t.AlbumId = a.AlbumId
WHERE
	a.Title = 'Appetite for Destruction';</sql><sql name="SQL 11">/*
CREATED ON: 2024-11-18
CREATED BY: DARREN WIEBE
DESCRIPTION: Create a view to use in Power Query and Power BI.
*/

CREATE VIEW vw_invoices

AS	

SELECT

--employees
e.EmployeeId,
e.LastName,
e.FirstName,

--customers
c.CustomerId,
c.State,
c.Country,
c.SupportRepId,

--invoices
i.InvoiceId,
i.CustomerId,
i.InvoiceDate,
i.BillingState,
i.BillingCountry,
i.total,

--invoice_items
ii.InvoiceId,
ii.TrackId,
ii.UnitPrice,

--tracks
t.TrackId,
t.GenreId,
t.UnitPrice,

--genres
g.GenreId,
g.name,

--Last Refresh Date
datetime(current_timestamp, 'localtime') AS [Last Refresh Date]

FROM
	employees e 
	INNER JOIN customers c ON c.SupportRepId = e.EmployeeId
	INNER JOIN invoices i ON i.CustomerId = c.CustomerId
	INNER JOIN invoice_items ii ON ii.InvoiceId = i.InvoiceId
	INNER JOIN tracks t ON ii.TrackId = t.TrackId
	INNER JOIN genres g ON t.GenreId = g.GenreId;












</sql><current_tab id="9"/></tab_sql></sqlb_project>
